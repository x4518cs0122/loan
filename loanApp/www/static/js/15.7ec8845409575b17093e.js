webpackJsonp([15],{HwAv:function(t,e){},UUg5:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=r("4YfN"),o=r.n(s),i=r("3cXf"),n=r.n(i),a=r("lC5x"),c=r.n(a),u=r("J0Oq"),p=r.n(u),l=r("hxP8"),d=r("iMdm"),f=r("MMGN"),h=r("P9rx"),v=r("u9a8"),b=r("9rMa"),m=r("P9l9"),_=r("rGUG"),j=r("XBEQ"),g={data:function(){return{reportObj:{},obj:{time:"",type:2},reports:[],errorMessage:""}},created:function(){this._getReport()},methods:{goback:function(){this.$router.push({path:"/approve/"+this.customer.id})},selected:function(t,e){this.obj[e]="time"!==e?parseInt(t):new Date(t).getTime()},_getReport:function(){var t=this;return p()(c.a.mark(function e(){var r,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.customer.rootId,s=void 0,e.next=4,Object(m.D)(r).then(function(t){var e=t.data.find(function(t){return"order"===t.name});s=e.id});case 4:Object(m.E)(s).then(function(e){e.result&&(t.reports=Object(j.b)(e.data))});case 5:case"end":return e.stop()}},e,t)}))()},editReport:function(t){this.reportObj=t,this.$refs.unreported.show()},deleteReport:function(t,e){1!==e.length&&e.splice(t,1)},checkDataValite:function(){var t=this.reports.some(function(t){return t.length>1});return t&&(this.errorMessage="每个房子只能有一份正评",this.$refs.topTip.show()),"number"!=typeof this.obj.time?(this.errorMessage="时间不能为空",this.$refs.topTip.show(),!0):t},submit:function(){var t=this;if(!this.checkDataValite()){this.reports.forEach(function(e){e.forEach(function(e){e.reportType=t.obj.type,e.type=t.obj.type,e.time=t.obj.time})});var e=[];this.reports.forEach(function(t){e=e.concat(t)}),Object(m.j)(this.customer.id,this.obj.time,n()(e)).then(function(e){e.result&&t.$router.push({path:"/approve"})})}}},computed:o()({},Object(b.b)(["customer"])),components:{vHeader:l.a,unreported:d.a,rsList:f.a,rsText:h.a,rsSelect:v.a,topTip:_.a}},C={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"reports"},[r("v-header",{attrs:{title:"测评报告管理",next:"提交"},on:{goback:t.goback,submit:t.submit}}),t._v(" "),r("rs-list",[r("ul",{attrs:{slot:"body"},slot:"body"},[r("li",[r("rs-text",{attrs:{label:"房产编号",value:t.customer.id}})],1),t._v(" "),r("li",[r("rs-select",{attrs:{selectText:"完成时间",model:"time",isDate:!0},on:{selected:t.selected}})],1)]),t._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},t._l(t.reports,function(e,s){return r("div",{key:s},t._l(e,function(o,i){return r("div",{key:i,staticClass:"report-wrapper"},[o.houseId?r("div",{staticClass:"report-content"},[r("h2",{staticClass:"title"},[t._v("房产"+t._s(s+1)+"报告")])]):t._e(),t._v(" "),r("div",{staticClass:"report-footer"},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.length>1,expression:"eachHouseReports.length > 1"}],staticClass:"delete",on:{click:function(r){t.deleteReport(i,e)}}},[r("i",{staticClass:"el-icon-delete icon"}),t._v(" "),r("span",[t._v("删除")])]),t._v(" "),r("div",{staticClass:"edit",on:{click:function(e){t.editReport(o)}}},[r("i",{staticClass:"el-icon-edit-outline icon"}),t._v(" "),r("span",[t._v("编辑")])])])])}))}))]),t._v(" "),r("top-tip",{ref:"topTip"},[r("div",{staticClass:"tip-title"},[r("i",{staticClass:"fa fa-ban icon"}),t._v(" "),r("span",{staticClass:"text"},[t._v(t._s(t.errorMessage))])])]),t._v(" "),r("unreported",{ref:"unreported",attrs:{obj:t.reportObj}})],1)},staticRenderFns:[]};var w=r("C7Lr")(g,C,!1,function(t){r("HwAv")},"data-v-c76e7d1e",null);e.default=w.exports}});
//# sourceMappingURL=15.7ec8845409575b17093e.js.map